<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>XZ Utils: liblzma/check/sha256.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">XZ Utils
   &#160;<span id="projectnumber">5.1.0alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2e0898c272e1f0f93c8ef15f5da2a912.html">liblzma</a></li><li class="navelem"><a class="el" href="dir_32e8ef00be12127410478e93c5f07fec.html">check</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sha256.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SHA-256.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;check.h&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad26d1f631a84e8bf3706cf39c23a06a0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad26d1f631a84e8bf3706cf39c23a06a0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>rotr_32</b>(num, amount)&#160;&#160;&#160;((num) &gt;&gt; (amount) | (num) &lt;&lt; (32 - (amount)))</td></tr>
<tr class="memitem:a1a75de24d0277c5319098c218efaef2d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a75de24d0277c5319098c218efaef2d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>blk0</b>(i)&#160;&#160;&#160;(W[i] = data[i])</td></tr>
<tr class="memitem:adbe8c231d3e02ee92deb523592868e5c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>blk2</b>(i)</td></tr>
<tr class="memitem:ab0a0d1ad13c7e4d3cb38c89f7127c85a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0a0d1ad13c7e4d3cb38c89f7127c85a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>Ch</b>(x, y, z)&#160;&#160;&#160;(z ^ (x &amp; (y ^ z)))</td></tr>
<tr class="memitem:a447cd1d7fb703b62666400976be24bf3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a447cd1d7fb703b62666400976be24bf3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>Maj</b>(x, y, z)&#160;&#160;&#160;((x &amp; y) | (z &amp; (x | y)))</td></tr>
<tr class="memitem:aa9b8e98b3989bdffd7f36b281c72a693"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa9b8e98b3989bdffd7f36b281c72a693"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>a</b>(i)&#160;&#160;&#160;T[(0 - i) &amp; 7]</td></tr>
<tr class="memitem:a337ad8a7e52da2d584c2018f2ec2c81e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a337ad8a7e52da2d584c2018f2ec2c81e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>b</b>(i)&#160;&#160;&#160;T[(1 - i) &amp; 7]</td></tr>
<tr class="memitem:a63f410abde93141c9013b7d3f3971738"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a63f410abde93141c9013b7d3f3971738"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>c</b>(i)&#160;&#160;&#160;T[(2 - i) &amp; 7]</td></tr>
<tr class="memitem:a23b5b0a85bf5762c93a855f40c0343ce"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a23b5b0a85bf5762c93a855f40c0343ce"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>d</b>(i)&#160;&#160;&#160;T[(3 - i) &amp; 7]</td></tr>
<tr class="memitem:af62772e2f383ddbe93a93eff2a5f543a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af62772e2f383ddbe93a93eff2a5f543a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>e</b>(i)&#160;&#160;&#160;T[(4 - i) &amp; 7]</td></tr>
<tr class="memitem:a357394e0f6f88c8a57bd893ab28dc8f8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a357394e0f6f88c8a57bd893ab28dc8f8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>f</b>(i)&#160;&#160;&#160;T[(5 - i) &amp; 7]</td></tr>
<tr class="memitem:a9608045402267746965fa49d90bbada4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9608045402267746965fa49d90bbada4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>g</b>(i)&#160;&#160;&#160;T[(6 - i) &amp; 7]</td></tr>
<tr class="memitem:acf9942d15f0dd0ac4fc5ca66096a3f6d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acf9942d15f0dd0ac4fc5ca66096a3f6d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>h</b>(i)&#160;&#160;&#160;T[(7 - i) &amp; 7]</td></tr>
<tr class="memitem:a56ed27be0074ed2f9162fb0ec556064f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>R</b>(i)</td></tr>
<tr class="memitem:a4fe3c738087e923a3174ad2a116e3be5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fe3c738087e923a3174ad2a116e3be5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>S0</b>(x)&#160;&#160;&#160;(rotr_32(x, 2) ^ rotr_32(x, 13) ^ rotr_32(x, 22))</td></tr>
<tr class="memitem:a59c41bcd16cbf3247d426429c3bf8e08"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59c41bcd16cbf3247d426429c3bf8e08"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>S1</b>(x)&#160;&#160;&#160;(rotr_32(x, 6) ^ rotr_32(x, 11) ^ rotr_32(x, 25))</td></tr>
<tr class="memitem:aa4074fe219868f65efa393f656020fed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4074fe219868f65efa393f656020fed"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>s0</b>(x)&#160;&#160;&#160;(rotr_32(x, 7) ^ rotr_32(x, 18) ^ (x &gt;&gt; 3))</td></tr>
<tr class="memitem:ac1e4ed4e56436a432900cad5a1225731"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1e4ed4e56436a432900cad5a1225731"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>s1</b>(x)&#160;&#160;&#160;(rotr_32(x, 17) ^ rotr_32(x, 19) ^ (x &gt;&gt; 10))</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aab742c9379fbbf2e38dcfb29723dbe74"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab742c9379fbbf2e38dcfb29723dbe74"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>transform</b> (uint32_t state[static 8], const uint32_t data[static 16])</td></tr>
<tr class="memitem:a1a3c107d249ff7adedee1b0d94557500"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a3c107d249ff7adedee1b0d94557500"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>process</b> (<a class="el" href="structlzma__check__state.html">lzma_check_state</a> *<a class="el" href="coder_8c.html#a5c94b0defea7996f245faec2693056cb">check</a>)</td></tr>
<tr class="memitem:a50600904325e18ab14051ee24bd3264b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha256_8c.html#a50600904325e18ab14051ee24bd3264b">lzma_sha256_init</a> (<a class="el" href="structlzma__check__state.html">lzma_check_state</a> *<a class="el" href="coder_8c.html#a5c94b0defea7996f245faec2693056cb">check</a>)</td></tr>
<tr class="memdesc:a50600904325e18ab14051ee24bd3264b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare SHA-256 state for new input.  <a href="#a50600904325e18ab14051ee24bd3264b"></a><br/></td></tr>
<tr class="memitem:a35110ebc966a6e20c018151ddb556e4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha256_8c.html#a35110ebc966a6e20c018151ddb556e4a">lzma_sha256_update</a> (const uint8_t *buf, size_t size, <a class="el" href="structlzma__check__state.html">lzma_check_state</a> *<a class="el" href="coder_8c.html#a5c94b0defea7996f245faec2693056cb">check</a>)</td></tr>
<tr class="memdesc:a35110ebc966a6e20c018151ddb556e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the SHA-256 hash state.  <a href="#a35110ebc966a6e20c018151ddb556e4a"></a><br/></td></tr>
<tr class="memitem:aa53f5151949f03053bc08425e87a4df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha256_8c.html#aa53f5151949f03053bc08425e87a4df5">lzma_sha256_finish</a> (<a class="el" href="structlzma__check__state.html">lzma_check_state</a> *<a class="el" href="coder_8c.html#a5c94b0defea7996f245faec2693056cb">check</a>)</td></tr>
<tr class="memdesc:aa53f5151949f03053bc08425e87a4df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finish the SHA-256 calculation and store the result to check-&gt;buffer.u8.  <a href="#aa53f5151949f03053bc08425e87a4df5"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab8f3ad1f1c5d0564c306a6714b2e4d08"><td class="memItemLeft" align="right" valign="top">static const uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>SHA256_K</b> [64]</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>SHA-256. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Crypto++ has x86 ASM optimizations. They use SSE so if they are imported to liblzma, SSE instructions need to be used conditionally to keep the code working on older boxes. We could also support using some external libary for SHA-256. </dd></dl>
</div><h2>Macro Definition Documentation</h2>
<a class="anchor" id="adbe8c231d3e02ee92deb523592868e5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blk2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(W[i &amp; 15] += s1(W[(i - 2) &amp; 15]) + W[(i - 7) &amp; 15] \</div>
<div class="line">                + s0(W[(i - 15) &amp; 15]))</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a56ed27be0074ed2f9162fb0ec556064f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define R</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">h(i) += S1(e(i)) + Ch(e(i), f(i), g(i)) + SHA256_K[i + j] \</div>
<div class="line">                + (j ? blk2(i) : blk0(i)); \</div>
<div class="line">        d(i) += h(i); \</div>
<div class="line">        h(i) += S0(a(i)) + Maj(a(i), b(i), c(i))</div>
</div><!-- fragment -->
</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a50600904325e18ab14051ee24bd3264b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lzma_sha256_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlzma__check__state.html">lzma_check_state</a> *&#160;</td>
          <td class="paramname"><em>check</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare SHA-256 state for new input. </p>

<p>References <a class="el" href="structlzma__sha256__state.html#a62337a1a0d34a9702ab4a438da383794">lzma_sha256_state::size</a>, <a class="el" href="structlzma__sha256__state.html#adb885aab736aae3772761f6c663c40be">lzma_sha256_state::state</a>, and <a class="el" href="structlzma__check__state.html#af30e2332a697d110c3fb2e4aa6b99178">lzma_check_state::state</a>.</p>

<p>Referenced by <a class="el" href="check_8c.html#aeb14796081bbe051ca7a08952c7383e8">lzma_check_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a35110ebc966a6e20c018151ddb556e4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lzma_sha256_update </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlzma__check__state.html">lzma_check_state</a> *&#160;</td>
          <td class="paramname"><em>check</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the SHA-256 hash state. </p>

<p>References <a class="el" href="structlzma__check__state.html#a66d54715269b349088561ee800cd2356">lzma_check_state::buffer</a>, <a class="el" href="structlzma__sha256__state.html#a62337a1a0d34a9702ab4a438da383794">lzma_sha256_state::size</a>, and <a class="el" href="structlzma__check__state.html#af30e2332a697d110c3fb2e4aa6b99178">lzma_check_state::state</a>.</p>

<p>Referenced by <a class="el" href="check_8c.html#aa5e9d54e127d31eda8e4f31cbe69e150">lzma_check_update()</a>.</p>

</div>
</div>
<a class="anchor" id="aa53f5151949f03053bc08425e87a4df5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lzma_sha256_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlzma__check__state.html">lzma_check_state</a> *&#160;</td>
          <td class="paramname"><em>check</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finish the SHA-256 calculation and store the result to check-&gt;buffer.u8. </p>

<p>References <a class="el" href="structlzma__check__state.html#a66d54715269b349088561ee800cd2356">lzma_check_state::buffer</a>, <a class="el" href="structlzma__sha256__state.html#a62337a1a0d34a9702ab4a438da383794">lzma_sha256_state::size</a>, <a class="el" href="structlzma__sha256__state.html#adb885aab736aae3772761f6c663c40be">lzma_sha256_state::state</a>, and <a class="el" href="structlzma__check__state.html#af30e2332a697d110c3fb2e4aa6b99178">lzma_check_state::state</a>.</p>

<p>Referenced by <a class="el" href="check_8c.html#a682bfef0e2be646de63dbcba0eb6a33e">lzma_check_finish()</a>.</p>

</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="ab8f3ad1f1c5d0564c306a6714b2e4d08"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint32_t SHA256_K[64]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"> {</div>
<div class="line">        0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,</div>
<div class="line">        0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,</div>
<div class="line">        0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,</div>
<div class="line">        0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,</div>
<div class="line">        0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,</div>
<div class="line">        0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,</div>
<div class="line">        0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,</div>
<div class="line">        0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,</div>
<div class="line">        0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,</div>
<div class="line">        0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,</div>
<div class="line">        0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,</div>
<div class="line">        0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,</div>
<div class="line">        0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,</div>
<div class="line">        0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,</div>
<div class="line">        0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,</div>
<div class="line">        0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2,</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 5 2014 14:29:27 for XZ Utils by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
