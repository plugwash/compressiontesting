\section{liblzma/check/sha256.c File Reference}
\label{sha256_8c}\index{liblzma/check/sha256.\-c@{liblzma/check/sha256.\-c}}


S\-H\-A-\/256.  


{\ttfamily \#include \char`\"{}check.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries rotr\-\_\-32}(num, amount)~((num) $>$$>$ (amount) $|$ (num) $<$$<$ (32 -\/ (amount)))\label{sha256_8c_ad26d1f631a84e8bf3706cf39c23a06a0}

\item 
\#define {\bfseries blk0}(i)~(W[i] = data[i])\label{sha256_8c_a1a75de24d0277c5319098c218efaef2d}

\item 
\#define {\bfseries blk2}(i)
\item 
\#define {\bfseries Ch}(x, y, z)~(z $^\wedge$ (x \& (y $^\wedge$ z)))\label{sha256_8c_ab0a0d1ad13c7e4d3cb38c89f7127c85a}

\item 
\#define {\bfseries Maj}(x, y, z)~((x \& y) $|$ (z \& (x $|$ y)))\label{sha256_8c_a447cd1d7fb703b62666400976be24bf3}

\item 
\#define {\bfseries a}(i)~T[(0 -\/ i) \& 7]\label{sha256_8c_aa9b8e98b3989bdffd7f36b281c72a693}

\item 
\#define {\bfseries b}(i)~T[(1 -\/ i) \& 7]\label{sha256_8c_a337ad8a7e52da2d584c2018f2ec2c81e}

\item 
\#define {\bfseries c}(i)~T[(2 -\/ i) \& 7]\label{sha256_8c_a63f410abde93141c9013b7d3f3971738}

\item 
\#define {\bfseries d}(i)~T[(3 -\/ i) \& 7]\label{sha256_8c_a23b5b0a85bf5762c93a855f40c0343ce}

\item 
\#define {\bfseries e}(i)~T[(4 -\/ i) \& 7]\label{sha256_8c_af62772e2f383ddbe93a93eff2a5f543a}

\item 
\#define {\bfseries f}(i)~T[(5 -\/ i) \& 7]\label{sha256_8c_a357394e0f6f88c8a57bd893ab28dc8f8}

\item 
\#define {\bfseries g}(i)~T[(6 -\/ i) \& 7]\label{sha256_8c_a9608045402267746965fa49d90bbada4}

\item 
\#define {\bfseries h}(i)~T[(7 -\/ i) \& 7]\label{sha256_8c_acf9942d15f0dd0ac4fc5ca66096a3f6d}

\item 
\#define {\bfseries R}(i)
\item 
\#define {\bfseries S0}(x)~(rotr\-\_\-32(x, 2) $^\wedge$ rotr\-\_\-32(x, 13) $^\wedge$ rotr\-\_\-32(x, 22))\label{sha256_8c_a4fe3c738087e923a3174ad2a116e3be5}

\item 
\#define {\bfseries S1}(x)~(rotr\-\_\-32(x, 6) $^\wedge$ rotr\-\_\-32(x, 11) $^\wedge$ rotr\-\_\-32(x, 25))\label{sha256_8c_a59c41bcd16cbf3247d426429c3bf8e08}

\item 
\#define {\bfseries s0}(x)~(rotr\-\_\-32(x, 7) $^\wedge$ rotr\-\_\-32(x, 18) $^\wedge$ (x $>$$>$ 3))\label{sha256_8c_aa4074fe219868f65efa393f656020fed}

\item 
\#define {\bfseries s1}(x)~(rotr\-\_\-32(x, 17) $^\wedge$ rotr\-\_\-32(x, 19) $^\wedge$ (x $>$$>$ 10))\label{sha256_8c_ac1e4ed4e56436a432900cad5a1225731}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void {\bfseries transform} (uint32\-\_\-t state[static 8], const uint32\-\_\-t data[static 16])\label{sha256_8c_aab742c9379fbbf2e38dcfb29723dbe74}

\item 
static void {\bfseries process} ({\bf lzma\-\_\-check\-\_\-state} $\ast${\bf check})\label{sha256_8c_a1a3c107d249ff7adedee1b0d94557500}

\item 
void {\bf lzma\-\_\-sha256\-\_\-init} ({\bf lzma\-\_\-check\-\_\-state} $\ast${\bf check})
\begin{DoxyCompactList}\small\item\em Prepare S\-H\-A-\/256 state for new input. \end{DoxyCompactList}\item 
void {\bf lzma\-\_\-sha256\-\_\-update} (const uint8\-\_\-t $\ast$buf, size\-\_\-t size, {\bf lzma\-\_\-check\-\_\-state} $\ast${\bf check})
\begin{DoxyCompactList}\small\item\em Update the S\-H\-A-\/256 hash state. \end{DoxyCompactList}\item 
void {\bf lzma\-\_\-sha256\-\_\-finish} ({\bf lzma\-\_\-check\-\_\-state} $\ast${\bf check})
\begin{DoxyCompactList}\small\item\em Finish the S\-H\-A-\/256 calculation and store the result to check-\/$>$buffer.\-u8. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const uint32\-\_\-t {\bfseries S\-H\-A256\-\_\-\-K} [64]
\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\-H\-A-\/256. \begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]Crypto++ has x86 A\-S\-M optimizations. They use S\-S\-E so if they are imported to liblzma, S\-S\-E instructions need to be used conditionally to keep the code working on older boxes. We could also support using some external libary for S\-H\-A-\/256. \end{DoxyRefDesc}


\subsection{Macro Definition Documentation}
\index{sha256.\-c@{sha256.\-c}!blk2@{blk2}}
\index{blk2@{blk2}!sha256.c@{sha256.\-c}}
\subsubsection[{blk2}]{\setlength{\rightskip}{0pt plus 5cm}\#define blk2(
\begin{DoxyParamCaption}
\item[{}]{i}
\end{DoxyParamCaption}
)}\label{sha256_8c_adbe8c231d3e02ee92deb523592868e5c}
{\bfseries Value\-:}
\begin{DoxyCode}
(W[i & 15] += s1(W[(i - 2) & 15]) + W[(i - 7) & 15] \(\backslash\)
                + s0(W[(i - 15) & 15]))
\end{DoxyCode}
\index{sha256.\-c@{sha256.\-c}!R@{R}}
\index{R@{R}!sha256.c@{sha256.\-c}}
\subsubsection[{R}]{\setlength{\rightskip}{0pt plus 5cm}\#define R(
\begin{DoxyParamCaption}
\item[{}]{i}
\end{DoxyParamCaption}
)}\label{sha256_8c_a56ed27be0074ed2f9162fb0ec556064f}
{\bfseries Value\-:}
\begin{DoxyCode}
h(i) += S1(e(i)) + Ch(e(i), f(i), g(i)) + SHA256\_K[i + j] \(\backslash\)
                + (j ? blk2(i) : blk0(i)); \(\backslash\)
        d(i) += h(i); \(\backslash\)
        h(i) += S0(a(i)) + Maj(a(i), b(i), c(i))
\end{DoxyCode}


\subsection{Function Documentation}
\index{sha256.\-c@{sha256.\-c}!lzma\-\_\-sha256\-\_\-init@{lzma\-\_\-sha256\-\_\-init}}
\index{lzma\-\_\-sha256\-\_\-init@{lzma\-\_\-sha256\-\_\-init}!sha256.c@{sha256.\-c}}
\subsubsection[{lzma\-\_\-sha256\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lzma\-\_\-sha256\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf lzma\-\_\-check\-\_\-state} $\ast$}]{check}
\end{DoxyParamCaption}
)}\label{sha256_8c_a50600904325e18ab14051ee24bd3264b}


Prepare S\-H\-A-\/256 state for new input. 



References lzma\-\_\-sha256\-\_\-state\-::size, lzma\-\_\-sha256\-\_\-state\-::state, and lzma\-\_\-check\-\_\-state\-::state.



Referenced by lzma\-\_\-check\-\_\-init().

\index{sha256.\-c@{sha256.\-c}!lzma\-\_\-sha256\-\_\-update@{lzma\-\_\-sha256\-\_\-update}}
\index{lzma\-\_\-sha256\-\_\-update@{lzma\-\_\-sha256\-\_\-update}!sha256.c@{sha256.\-c}}
\subsubsection[{lzma\-\_\-sha256\-\_\-update}]{\setlength{\rightskip}{0pt plus 5cm}void lzma\-\_\-sha256\-\_\-update (
\begin{DoxyParamCaption}
\item[{const uint8\-\_\-t $\ast$}]{buf, }
\item[{size\-\_\-t}]{size, }
\item[{{\bf lzma\-\_\-check\-\_\-state} $\ast$}]{check}
\end{DoxyParamCaption}
)}\label{sha256_8c_a35110ebc966a6e20c018151ddb556e4a}


Update the S\-H\-A-\/256 hash state. 



References lzma\-\_\-check\-\_\-state\-::buffer, lzma\-\_\-sha256\-\_\-state\-::size, and lzma\-\_\-check\-\_\-state\-::state.



Referenced by lzma\-\_\-check\-\_\-update().

\index{sha256.\-c@{sha256.\-c}!lzma\-\_\-sha256\-\_\-finish@{lzma\-\_\-sha256\-\_\-finish}}
\index{lzma\-\_\-sha256\-\_\-finish@{lzma\-\_\-sha256\-\_\-finish}!sha256.c@{sha256.\-c}}
\subsubsection[{lzma\-\_\-sha256\-\_\-finish}]{\setlength{\rightskip}{0pt plus 5cm}void lzma\-\_\-sha256\-\_\-finish (
\begin{DoxyParamCaption}
\item[{{\bf lzma\-\_\-check\-\_\-state} $\ast$}]{check}
\end{DoxyParamCaption}
)}\label{sha256_8c_aa53f5151949f03053bc08425e87a4df5}


Finish the S\-H\-A-\/256 calculation and store the result to check-\/$>$buffer.\-u8. 



References lzma\-\_\-check\-\_\-state\-::buffer, lzma\-\_\-sha256\-\_\-state\-::size, lzma\-\_\-sha256\-\_\-state\-::state, and lzma\-\_\-check\-\_\-state\-::state.



Referenced by lzma\-\_\-check\-\_\-finish().



\subsection{Variable Documentation}
\index{sha256.\-c@{sha256.\-c}!S\-H\-A256\-\_\-\-K@{S\-H\-A256\-\_\-\-K}}
\index{S\-H\-A256\-\_\-\-K@{S\-H\-A256\-\_\-\-K}!sha256.c@{sha256.\-c}}
\subsubsection[{S\-H\-A256\-\_\-\-K}]{\setlength{\rightskip}{0pt plus 5cm}const uint32\-\_\-t S\-H\-A256\-\_\-\-K[64]\hspace{0.3cm}{\ttfamily [static]}}\label{sha256_8c_ab8f3ad1f1c5d0564c306a6714b2e4d08}
{\bfseries Initial value\-:}
\begin{DoxyCode}
 \{
        0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,
        0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,
        0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,
        0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,
        0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,
        0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,
        0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,
        0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,
        0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,
        0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,
        0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,
        0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,
        0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,
        0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,
        0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,
        0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2,
\}
\end{DoxyCode}
